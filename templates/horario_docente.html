{% extends 'base.html' %}
{% block title %}Horario Docente{% endblock %}
{% block content %}
<div class="container py-4">
  <h2 class="mb-4">Horario de {{ docente.nombres }} {{ docente.apellido_paterno }} {{ docente.apellido_materno }}</h2>

  <form method="POST" class="row g-3 mb-4">
    <div class="col-md-4">
      <label class="form-label">Días</label><br>
      <div class="d-flex flex-wrap gap-2">
        {% for dia in ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes'] %}
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="dias" value="{{ dia }}">
            <label class="form-check-label">{{ dia }}</label>
          </div>
        {% endfor %}
      </div>
    </div>
    <div class="col-md-3">
      <label class="form-label">Hora Inicio</label>
      <input type="time" name="hora_inicio" class="form-control" required>
    </div>
    <div class="col-md-3">
      <label class="form-label">Hora Fin</label>
      <input type="time" name="hora_fin" class="form-control" required>
    </div>
    <div class="col-md-2 d-grid">
      <label class="form-label invisible">Guardar</label>
      <button class="btn btn-primary">Agregar</button>
    </div>
  </form>

  <table class="table table-bordered">
    <thead class="table-light">
      <tr><th>Día</th><th>Hora Inicio</th><th>Hora Fin</th><th>Acciones</th></tr>
    </thead>
    <tbody>
      {% for h in horarios %}
      <tr>
        <td>{{ h.dia_semana }}</td>
        <td>{{ h.hora_inicio }}</td>
        <td>{{ h.hora_fin }}</td>
        <td>
          <a href="#" 
            class="btn btn-sm btn-outline-danger btn-eliminar-horario"
            data-url="{{ url_for('teachers.eliminar_horario', horario_id=h.id, dni=docente.dni) }}">
            <i class="bi bi-trash3"></i>
          </a>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="4" class="text-center">Sin horarios asignados.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<script>
document.querySelectorAll('.btn-eliminar-horario').forEach(btn => {
  btn.addEventListener('click', function(e) {
    e.preventDefault();
    const url = this.dataset.url;

    Swal.fire({
      title: '¿Deseas eliminar este horario?',
      text: "Esta acción no se puede deshacer",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonText: 'Sí, eliminar',
      cancelButtonText: 'Cancelar',
      confirmButtonColor: '#d33',
      cancelButtonColor: '#3085d6'
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = url;
      }
    });
  });
});
</script>
{% endblock %}
